---
title: 安全防御实例
categories:
- 漏洞及安全
tags: 安全防御
date:
---

## 登录安全
1. 登陆失败不应提示“用户名不存在”等字眼；
2. 添加验证码或动态短信认证功能；

## 密码安全
1. 应限制密码至少长度、复杂度，管理员密码最少长度为8位，普通用户密码最少长度为6位，同时要求密码必须由三种以上的组合组成，保证系统中不存在弱口令等；
2. 应限制密码的最长使用期限；在密码过期后应强制要求修改密码，同时密码不可重用；

## 访问控制
1. 应为用户配置相应的角色，各个角色分配不同的页面及内容控制权限，尽可能控制到读、写、删粒度；

## 登录失败策略
1. 限制用户登录的次数或添加用户登录验证码，防止密码穷举攻击；
> **思路：超过一定登录失败次数后，一定时间内限制当前ip再次登录操作等**

## 安全审计日志
1. 审计日志应覆盖到所有用户，包括管理员的所有操作；
2. 审计日志应不提供删除功能，最好可存在日志服务器；
3. 审计记录内容应至少包括：日期、时间、发起者、类型、描述、结果等；

## 会话管理
1. 应设置相应的会话超时时间；
2. 退出登录时应清除相应的身份信息，如session内容；
3. 用户登录或退出后，应重新分配sessionid，防止会话id复用；
4. 会话sessionid应确保只有一人使用，防止sessionid被盗导致会话id复用；

## 内容管理
1. 应对相应敏感的字段进行加密存储到数据库中，如采用rsa加密、哈希散列等；
2. 屏蔽错误的提示，防止泄露敏感的信息或debug信息；



